<!DOCTYPE html>
<html class="dark" lang="ko">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" name="viewport"/>
    <title>English App V2</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;900&amp;family=JetBrains+Mono:wght@500&amp;display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet"/>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        primary: "#39FF14", 
                        "background-dark": "#050505",
                        "card-dark": "#121212",
                    },
                    fontFamily: {
                        display: ["Inter", "sans-serif"],
                        mono: ["JetBrains Mono", "monospace"],
                    },
                    boxShadow: {
                        'neon': '0 0 20px rgba(57, 255, 20, 0.4)',
                        'neon-strong': '0 0 30px rgba(57, 255, 20, 0.6)',
                    }
                },
            },
        };
    </script>
    <style>
        body { background-color: #000; color: white; }
        .glass-panel { background: rgba(18, 18, 18, 0.8); backdrop-filter: blur(12px); border-top: 1px solid rgba(255, 255, 255, 0.05); }
        .shake { animation: shake 0.4s ease-in-out; }
        @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-5px); } 75% { transform: translateX(5px); } }
        /* ìŠ¤í¬ë¡¤ë°” ìˆ¨ê¹€ */
        ::-webkit-scrollbar { width: 0px; background: transparent; }
        /* ì…ë ¥ì°½ í”Œë ˆì´ìŠ¤í™€ë” ìƒ‰ìƒ ì¡°ì • */
        ::placeholder { color: #555; opacity: 1; }
        /* í…ìŠ¤íŠ¸ ê¸€ë¡œìš° íš¨ê³¼ */
        .text-glow { text-shadow: 0 0 10px rgba(57, 255, 20, 0.5); }
    </style>
</head>
<body class="bg-black font-display min-h-screen flex justify-center text-white">

<main class="w-full max-w-md h-screen flex flex-col relative overflow-hidden bg-black shadow-2xl">

    <div id="login-box" class="h-full flex flex-col items-center justify-center px-6 relative" style="display:flex;">
                
                <div class="w-full flex flex-col items-center -mt-40 space-y-6">
                    
                    <div class="text-center space-y-2">
                        <p class="text-[#39FF14] text-xs font-bold tracking-widest mb-4 opacity-80">SYSTEM ONLINE v2.5.0</p>
                        
                        <div class="mb-8">
                             <span class="material-icons-round text-7xl text-[#39FF14] drop-shadow-[0_0_15px_rgba(57,255,20,0.5)]">lock</span>
                        </div>
                        
                        <div>
                            <p class="text-[#39FF14] text-xs font-bold tracking-[0.2em] mb-1">ë°”ë¥´ê³  ë¹ ë¥¸ ì˜ì–´</p>
                            <h1 class="text-4xl font-black text-white italic tracking-tighter">
                                BUILD A <span class="text-[#39FF14]">MONSTER</span>
                            </h1>
                        </div>
                    </div>

                    <div class="w-full space-y-4">
                        <input type="tel" id="phone-input" placeholder="Enter the code" maxlength="11" 
                            class="w-full bg-[#1c1c1c] text-center text-white text-xl font-mono font-bold py-4 rounded-xl border border-neutral-800 focus:border-[#39FF14] focus:outline-none focus:shadow-[0_0_15px_rgba(57,255,20,0.2)] placeholder-neutral-600 transition-all tracking-widest">
                        
                        <button onclick="login()" class="w-full bg-[#39FF14] text-black font-black text-lg py-4 rounded-xl shadow-[0_0_20px_rgba(57,255,20,0.4)] active:scale-95 transition-transform hover:bg-[#32e012]">
                            LOGIN SYSTEM
                        </button>

                        <p class="text-[10px] text-neutral-500 text-center leading-relaxed break-keep px-1 mt-4">
                            ë³¸ ì–´í”Œë¦¬ì¼€ì´ì…˜ì— í¬í•¨ëœ ëª¨ë“  ì½˜í…ì¸ ëŠ” ì£¼ì‹íšŒì‚¬ ë°”ë¹ ì˜ì˜ ì§€ì  ì¬ì‚°ì´ë©°, ì €ì‘ê¶Œë²•ì˜ ë³´í˜¸ë¥¼ ë°›ìŠµë‹ˆë‹¤. í—ˆê°€ ì—†ì´ ë³µì œ, ë°°í¬, ì „ì†¡, ì „ì‹œ, ìƒì—…ì  ì´ìš©ì„ í•  ê²½ìš°, ì €ì‘ê¶Œë²• ì œ136ì¡° ë“±ì— ë”°ë¼ ë²•ì  ì±…ì„ì„ ë¬¼ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                        </p>
                    </div>
                </div>
            </div>

    <div id="app" style="display:none;" class="h-full flex flex-col relative z-10 bg-black">
        
        <header class="pt-10 pb-2 px-6 bg-black sticky top-0 z-30">
            <div class="space-y-1">
                <p class="text-primary text-xs font-bold tracking-wider uppercase">Training application</p>
                <h1 class="text-3xl font-black text-white tracking-tight">
                    Build A <span class="text-white">Monster</span>
                </h1>
            </div>
        </header>

        <div class="flex-1 overflow-y-auto px-5 pb-28 pt-4 space-y-6 scroll-smooth no-scrollbar" id="main-scroll">
            
            <div id="unit-selector">
                <div id="unit-buttons" class="grid grid-cols-1 gap-3">
                    </div>
            </div>

            <div id="menu-box" style="display:none;" class="px-2 pt-6">
                
                <h2 class="text-3xl font-black text-[#39FF14] text-center mb-10 uppercase tracking-tighter drop-shadow-[0_0_5px_rgba(57,255,20,0.5)]">
                    SELECT MODE
                </h2>
                
                <div class="grid grid-cols-2 gap-4 mb-5">
                    
                    <button onclick="startScriptMode()" class="h-40 border border-[#39FF14] bg-black rounded-2xl flex flex-col items-center justify-center gap-3 active:scale-95 transition-transform hover:bg-[#39FF14]/10 group">
                        <span class="material-icons-round text-5xl text-[#39FF14] group-hover:scale-110 transition-transform drop-shadow-[0_0_8px_rgba(57,255,20,0.4)]">record_voice_over</span>
                        <span class="font-black text-[#39FF14] tracking-widest text-xs uppercase">Script</span>
                    </button>

                    <button onclick="startVocaMode()" class="h-40 border border-[#39FF14] bg-black rounded-2xl flex flex-col items-center justify-center gap-3 active:scale-95 transition-transform hover:bg-[#39FF14]/10 group">
                        <span class="material-icons-round text-5xl text-[#39FF14] group-hover:scale-110 transition-transform drop-shadow-[0_0_8px_rgba(57,255,20,0.4)]">menu_book</span>
                        <span class="font-black text-[#39FF14] tracking-widest text-xs uppercase">Vocab</span>
                    </button>

                    <button onclick="startASMode()" class="h-40 border border-[#39FF14] bg-black rounded-2xl flex flex-col items-center justify-center gap-3 active:scale-95 transition-transform hover:bg-[#39FF14]/10 group">
                        <span class="material-icons-round text-5xl text-[#39FF14] group-hover:scale-110 transition-transform drop-shadow-[0_0_8px_rgba(57,255,20,0.4)]">spellcheck</span>
                        <span class="font-black text-[#39FF14] tracking-widest text-xs uppercase text-center leading-tight">AS<br>Correction</span>
                    </button>

                    <button onclick="startRepeatMode()" class="h-40 border border-[#39FF14] bg-black rounded-2xl flex flex-col items-center justify-center gap-3 active:scale-95 transition-transform hover:bg-[#39FF14]/10 group">
                        <span class="material-icons-round text-5xl text-[#39FF14] group-hover:scale-110 transition-transform drop-shadow-[0_0_8px_rgba(57,255,20,0.4)]">headset</span>
                        <span class="font-black text-[#39FF14] tracking-widest text-xs uppercase text-center leading-tight">Repeat<br>Listening</span>
                    </button>
                </div>

                <button onclick="startAccurateSpeakingMode()" class="w-full py-5 border border-[#39FF14] bg-black rounded-2xl font-black text-[#39FF14] tracking-[0.2em] text-sm uppercase active:scale-95 transition-transform hover:bg-[#39FF14]/10 drop-shadow-[0_0_5px_rgba(57,255,20,0.3)]">
                    Accurate Speaking
                </button>

            </div>

            <div id="study-box" style="display:none;" class="h-full flex flex-col">
                
                <div class="h-[65%] flex flex-col relative">
                    
                    <div class="w-full px-6 pt-6 z-10">
                        <div class="w-full bg-[#111] rounded-full h-3 mb-2 overflow-hidden border border-neutral-800">
                            <div id="progress" class="bg-[#39FF14] h-full rounded-full transition-all duration-300 shadow-[0_0_15px_#39FF14]" style="width: 0%"></div>
                        </div>
                        <div id="progress-percent" class="text-right text-sm font-bold font-mono text-[#39FF14] tracking-widest">0%</div>
                    </div>

                    <div class="flex-1 flex flex-col justify-center items-center text-center px-4 pb-4">
                        <p id="sentence" class="text-2xl font-black text-white leading-snug drop-shadow-md break-keep min-h-[4rem] flex items-center justify-center">
                            Ready?
                        </p>
                        <p id="sentence-kor" class="text-sm text-slate-500 font-medium tracking-wide break-keep mt-4 min-h-[1.5rem]"></p>
                    </div>
                </div>

                <div class="h-[35%] w-full px-6 flex flex-col justify-start gap-3">
                    <button id="start-btn" onclick="startStudy()" class="w-full bg-[#39FF14] text-black font-black text-lg py-4 rounded-xl shadow-[0_0_20px_rgba(57,255,20,0.3)] active:scale-95 transition-transform uppercase tracking-widest hover:bg-[#32e012]">
                        Start
                    </button>

                    <div class="grid grid-cols-2 gap-3 h-14">
                        <button id="skip-btn" onclick="skipSentence()" class="bg-[#1c1c1c] text-white font-bold rounded-xl border border-neutral-800 active:border-[#39FF14] active:text-[#39FF14] transition-all hover:bg-[#252525]" style="display:none;">
                            Skip
                        </button>
                        
                        <button onclick="showMenu()" class="w-full h-full bg-[#1c1c1c] text-white font-bold rounded-xl border border-neutral-800 active:border-[#39FF14] active:text-[#39FF14] transition-all hover:bg-[#252525] col-span-2" id="back-btn">
                            Back
                        </button>
                    </div>
                </div>

            </div>

            <div id="repeat-box" style="display:none;"></div>
            <div id="as-box" style="display:none;"></div>
            <div id="as-record-box" style="display:none;"></div>
            
            <div id="results-box" style="display:none;">
                <h2 class="text-primary font-bold text-xl mb-6 pl-1">Progress Report</h2>
                <div id="results-content" class="space-y-3"></div>
            </div>
            
            <div id="dev-box" style="display:none;" class="flex flex-col items-center justify-center h-[50vh]">
                <div class="w-10 h-10 border-4 border-primary border-t-transparent rounded-full animate-spin"></div>
            </div>
        </div>

        <nav class="fixed bottom-0 w-full bg-[#111] h-[90px] border-t border-neutral-900 flex justify-around items-center pb-4 z-50 shadow-[0_-5px_20px_rgba(0,0,0,0.8)]">
            
            <button onclick="showMenu()" class="flex flex-col items-center justify-center w-16 group">
                <span class="material-icons-round text-2xl mb-1 text-[#39FF14] group-hover:drop-shadow-[0_0_8px_rgba(57,255,20,0.6)] transition-all">home</span>
                <span class="text-[10px] font-bold text-[#39FF14] h-7 flex items-start justify-center leading-tight text-center">
                    UNIT
                </span>
            </button>
            
            <button onclick="showReport()" class="flex flex-col items-center justify-center w-16 group">
                <span class="material-icons-round text-2xl mb-1 text-neutral-500 group-hover:text-white transition-colors">bar_chart</span>
                <span class="text-[10px] font-bold text-neutral-500 group-hover:text-white h-7 flex items-start justify-center leading-tight text-center transition-colors">
                    PROGRESS<br>REPORT
                </span>
            </button>
            
            <button onclick="showProfile()" class="flex flex-col items-center justify-center w-16 group">
                <span class="material-icons-round text-2xl mb-1 text-neutral-500 group-hover:text-white transition-colors">person</span>
                <span class="text-[10px] font-bold text-neutral-500 group-hover:text-white h-7 flex items-start justify-center leading-tight text-center transition-colors">
                    PROFILE
                </span>
            </button>
            
            <button onclick="showRanking()" class="flex flex-col items-center justify-center w-16 group">
                <span class="material-icons-round text-2xl mb-1 text-neutral-500 group-hover:text-white transition-colors">emoji_events</span>
                <span class="text-[10px] font-bold text-neutral-500 group-hover:text-white h-7 flex items-start justify-center leading-tight text-center transition-colors">
                    RANKING
                </span>
            </button>
        </nav>

    </div>

    <div id="custom-modal" class="fixed inset-0 z-50 flex items-center justify-center bg-black/90 backdrop-blur-sm px-6" style="display:none;">
        <div class="bg-[#1c1c1c] border border-neutral-800 rounded-2xl p-6 w-full max-w-sm text-center">
            <p id="modal-msg" class="text-white text-lg mb-6 leading-relaxed font-medium"></p>
            <button onclick="closeCustomModal()" class="w-full bg-primary text-black font-bold py-3 rounded-xl hover:bg-primary/90">OK</button>
        </div>
    </div>

</main>

<script src="app.js"></script>
<script>
    // ë¡œê·¸ì¸/ì•± í™”ë©´ ì „í™˜ ì‹œ í•˜ë‹¨ë°” ì²˜ë¦¬ ìŠ¤í¬ë¦½íŠ¸
    const originalShowBox = window.showBox;
    window.showBox = function(boxId) {
        const boxes = ['login-box', 'unit-selector', 'menu-box', 'study-box', 'repeat-box', 'dev-box', 'as-box', 'results-box', 'as-record-box'];
        boxes.forEach(id => {
            const el = document.getElementById(id);
            if(el) el.style.display = (id === boxId) ? 'block' : 'none';
        });
        
        // ë¡œê·¸ì¸ í™”ë©´ ì²˜ë¦¬
        const isLogin = (boxId === 'login-box');
        document.getElementById("app").style.display = isLogin ? 'none' : 'flex';
        document.getElementById('login-box').style.display = isLogin ? 'flex' : 'none';
        
        // [ìˆ˜ì • ì™„ë£Œ] í•˜ë‹¨ ë°” IDë¥¼ 'bottom-nav'ë¡œ í†µì¼í–ˆìŠµë‹ˆë‹¤!
        const navBar = document.getElementById('bottom-nav');
        if(navBar) {
            navBar.style.display = isLogin ? 'none' : 'flex';
        }

        // ë‚´ë¹„ê²Œì´ì…˜ ë°” ìƒíƒœ ì—…ë°ì´íŠ¸
        updateNavState(boxId);
    }

    function updateNavState(currentBox) {
        // ì•„ì´ì½˜ ìƒ‰ìƒ í™œì„±í™”/ë¹„í™œì„±í™” ì²˜ë¦¬
        const icons = document.querySelectorAll('#bottom-nav .material-icons-round');
        if(icons.length > 0) {
            if(currentBox === 'unit-selector') {
                icons[0].style.color = '#39FF14'; // Home ì•„ì´ì½˜ ì´ˆë¡ìƒ‰
            } else {
                icons[0].style.color = '#737373'; // Home ì•„ì´ì½˜ íšŒìƒ‰
            }
        }
    }

// ======================================================
// 7. í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ ê¸°ëŠ¥ (ë¦¬í¬íŠ¸ êµ¬í˜„ + ë‚˜ë¨¸ì§€ ì¤€ë¹„ì¤‘)
// ======================================================

// [ìˆ˜ì •] Progress Report: ì‹¤ì œ ë°ì´í„° ë¡œë“œ ë° í™”ë©´ í‘œì‹œ
window.showReport = async function() {
    const phoneInput = document.getElementById("phone-input");
    const phone = phoneInput ? phoneInput.value.trim() : "";
    
    if (!phone) return showCustomModal("ë¡œê·¸ì¸ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.");

    showCustomModal("ë¦¬í¬íŠ¸ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...", null, false); // ë¡œë”© ì¤‘ ë²„íŠ¼ ìˆ¨ê¹€

    try {
        // ë¦¬í¬íŠ¸ ë°ì´í„° ìš”ì²­
        const res = await fetch(`${GOOGLE_SCRIPT_URL}?action=getReport&phone=${phone}`);
        const data = await res.json();
        
        closeCustomModal();
        renderReportPage(data); // í™”ë©´ ê·¸ë¦¬ê¸°
        showBox('report-box');  // í™”ë©´ ì „í™˜

    } catch (e) {
        console.error(e);
        showCustomModal("ë¦¬í¬íŠ¸ ë¡œë“œ ì‹¤íŒ¨\n(ë°ì´í„° í™•ì¸ ë¶ˆê°€)");
    }
};

// [ì¶”ê°€] ë¦¬í¬íŠ¸ í™”ë©´ ë Œë”ë§ í•¨ìˆ˜
function renderReportPage(data) {
    let container = document.getElementById('report-box');
    if (!container) {
        // ë°•ìŠ¤ê°€ ì—†ìœ¼ë©´ ìƒˆë¡œ ìƒì„±
        container = document.createElement('div');
        container.id = 'report-box';
        document.body.appendChild(container); // ìœ„ì¹˜ëŠ” body ì§ê³„ë¡œ ì¡ê±°ë‚˜ ì ì ˆí•œ wrapper ì•ˆìœ¼ë¡œ
    }

    // ìŠ¤íƒ€ì¼: ASëª¨ë“œì™€ ë™ì¼í•˜ê²Œ í™”ë©´ ê³ ì • (ë„¤ë¹„ê²Œì´ì…˜ ë°” ìœ„ê¹Œì§€)
    container.className = "fixed top-[80px] bottom-[90px] left-0 right-0 z-30 bg-black overflow-y-auto no-scrollbar px-6 pb-10 flex flex-col";

    // ë°ì´í„° ì•ˆì „ ì²˜ë¦¬
    const name = data.name || "Unknown";
    const totalTime = data.totalTime || "0ë¶„";
    const loginCount = data.loginCount || 0;
    const lastUnit = data.lastUnit || "-";

    container.innerHTML = `
        <div class="mt-4 mb-8 text-center shrink-0">
            <h2 class="text-[#39FF14] text-lg font-bold">Progress Report</h2>
            <p class="text-neutral-500 text-xs mt-1">í•™ìŠµ í˜„í™© ë¶„ì„</p>
        </div>

        <div class="w-full bg-[#1c1c1c] rounded-2xl p-6 border border-neutral-800 mb-6 shadow-lg">
            <div class="flex items-center justify-between mb-4">
                <span class="text-white font-bold text-lg">${name}ë‹˜</span>
                <span class="px-2 py-1 bg-[#39FF14] text-black text-[10px] font-bold rounded">Active</span>
            </div>
            <div class="space-y-3">
                <div class="flex justify-between items-center">
                    <span class="text-neutral-500 text-xs">ì´ í•™ìŠµ ì‹œê°„</span>
                    <span class="text-white font-mono font-bold text-xl">${totalTime}</span>
                </div>
                <div class="w-full h-1 bg-neutral-800 rounded-full overflow-hidden">
                    <div class="h-full bg-[#39FF14] w-[60%]"></div> </div>
            </div>
        </div>

        <div class="grid grid-cols-2 gap-4 w-full mb-6">
            <div class="bg-[#1c1c1c] p-4 rounded-xl border border-neutral-800 flex flex-col items-center justify-center">
                <span class="material-icons-round text-[#39FF14] mb-2">calendar_today</span>
                <span class="text-white font-black text-2xl mb-1">${loginCount}</span>
                <span class="text-neutral-500 text-[10px] uppercase">Total Logins</span>
            </div>
            <div class="bg-[#1c1c1c] p-4 rounded-xl border border-neutral-800 flex flex-col items-center justify-center">
                <span class="material-icons-round text-[#ff4757] mb-2">flag</span>
                <span class="text-white font-black text-2xl mb-1">${lastUnit}</span>
                <span class="text-neutral-500 text-[10px] uppercase">Last Unit</span>
            </div>
        </div>

        <div class="mt-auto pt-4">
            <button onclick="showMenu()" class="w-full py-4 bg-[#1c1c1c] text-neutral-400 font-bold rounded-xl border border-neutral-800 active:border-white active:text-white transition-all text-sm uppercase tracking-wider">
                Back to Menu
            </button>
        </div>
    `;
}

// [ìœ ì§€] Profile & Rankingì€ ì¤€ë¹„ì¤‘ ì•Œë¦¼
window.showProfile = function() {
    showCustomModal("ğŸš§ì ê²€ì¤‘ì…ë‹ˆë‹¤.\n(Profile Coming Soon)");
};

window.showRanking = function() {
    showCustomModal("ğŸ†ê¸°ëŠ¥ ì¤€ë¹„ì¤‘ì…ë‹ˆë‹¤.\n(Ranking Coming Soon)");
};
    
</script>
</body>
</html>


